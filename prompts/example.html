<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" type="image/png" href="../assets/favicon.png" />
  <title>Pufflings - Dialogue Examples</title>
  <meta name="title" content="Pufflings - Dialogue Examples" />
  <meta name="type" content="website" />
  <meta name="url" content="https://pufflings.github.io/Masterlist/" />
  <meta name="image" content="../assets/meta.png" />
  <meta name="description" content="Quick reference for dialogue styling in the Pufflings project.">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
  <link rel="stylesheet" type="text/css" href="../styles/css/charadex.css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400|Comfortaa:500" rel="stylesheet">
</head>
<body id="charadex-body">
  <div class="load-html" id="header" data-source="../includes/header.html"></div>
  <div class="container" id="main-container">
    <div id="charadex-gallery">
      <div class="card p-md-5 p-4 mb-4">
        <h3 class="mb-0">Prompt Directory</h3>
        <h6><i>Auto-generated from /prompts</i></h6>
        <hr>
        <div class="text-justify my-4">
          <p class="mb-4">
            Browse every prompt-friendly HTML file that lives in this folder. The list refreshes itself by checking the repository,
            so adding or renaming files here updates the directory automatically.
          </p>
          <div id="prompt-directory" class="mt-3" data-github-owner="pufflings" data-github-repo="Masterlist_v2" data-github-branch="main">
            <div id="prompt-status" class="alert alert-info mb-3" role="status">Loading prompt index…</div>
            <div id="prompt-list" class="list-group"></div>
          </div>
        </div>
      </div>

      <div class="card p-md-5 p-4 mb-4">
        <h3 class="mb-0">Dialogue Style Showcase</h3>
        <h6><i>Scene — Styling Reference</i></h6>
        <hr>
        <div class="text-justify my-4">
          <p class="mb-4">Use this page to preview the three dialogue layouts plus the available size helper classes inside dialogue text.</p>

          <div id="dialogue-stage">
            <div class="dialogue-simple">
              <p><strong>Simple Dialogue:</strong> This block uses <code>&lt;div class="dialogue-simple"&gt;</code> without a portrait. It supports multiple paragraphs for spaced text.</p>
              <p>Paragraphs add extra spacing on their own. Using <code>&lt;br&gt;</code> keeps everything in the same paragraph<br>like this line, showing a tighter break without additional margins.</p>
              <p>The helpers work inside dialogue: <span class="small">small</span>, <span class="smaller">smaller</span>, <span class="smallest">smallest</span>, <span class="big">big</span>, <span class="bigger">bigger</span>, and <span class="bigest">bigest</span>.</p>
              <hr>
              <p><em>Italic text</em> and <strong>bold text</strong> render normally inside the bubble.</p>
            </div>

            <div class="dialogue-container">
              <div>
                <div class="character-portrait hidden-face">
                  <img src="https://img-l.ink/img/1Q3qjsS9uIf08-D758jjrUQG1CK3SczJp.png" alt="Poki" onerror="this.style.display='none'">
                </div>
              </div>
              <div class="speech-bubble">
                <div class="character-name">Guide</div>
                <p class="big">This is the standard left-aligned layout with a portrait.</p>
                <p><span class="bigger">Bigger text</span> is great for emphasis, while <span class="bigest">bigest</span> is a dramatic shout.</p>
              </div>
            </div>

            <div class="dialogue-container-right">
              <div>
                <div class="character-portrait">
                  <img src="https://img-l.ink/img/18mDK0Hw_VU2Etn2x1qx1rCJFY_G8kM4s.png" alt="Momo" onerror="this.style.display='none'">
                </div>
              </div>
              <div class="speech-bubble-right">
                <div class="character-name">Sidekick</div>
                <p><span class="small">Small</span> and <span class="smaller">smaller</span> whisper, while <span class="smallest">smallest</span> is a barely audible mutter.</p>
                <p><em>Mix italics</em> and <strong>bold</strong> as needed for tone.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="load-html" id="footer" data-source="../includes/footer.html"></div>

  <script src="https://code.jquery.com/jquery-3.6.0.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
  <script src="../styles/js/pages/base.js" type="module"></script>
  <script type="module">
    const directoryEl = document.getElementById('prompt-directory');
    const statusEl = document.getElementById('prompt-status');
    const listEl = document.getElementById('prompt-list');

    if (directoryEl && statusEl && listEl) {
      const owner = directoryEl.dataset.githubOwner || 'pufflings';
      const repo = directoryEl.dataset.githubRepo || 'Masterlist_v2';
      const branch = directoryEl.dataset.githubBranch || 'main';
      const cacheKey = 'pufflings_prompt_index_cache_v1';

      const renderList = (files, fromCache = false) => {
        listEl.innerHTML = '';
        const sorted = [...files].sort((a, b) => a.localeCompare(b));
        if (sorted.length === 0) {
          statusEl.classList.replace('alert-info', 'alert-warning');
          statusEl.textContent = 'No prompt pages found.';
          return;
        }

        const statusParent = statusEl.parentElement;
        statusEl.remove();
        if (fromCache && statusParent) {
          const note = document.createElement('div');
          note.className = 'alert alert-warning mb-3';
          note.textContent = 'Showing cached prompt list (live update unavailable right now).';
          statusParent.prepend(note);
        }

        for (const name of sorted) {
          const link = document.createElement('a');
          link.className = 'list-group-item list-group-item-action d-flex justify-content-between align-items-center';
          link.href = `./${name}`;
          link.setAttribute('data-prompt-file', name);
          link.innerHTML = `<span>${name}</span><span class="fa-solid fa-arrow-right ml-2"></span>`;
          listEl.appendChild(link);
        }
      };

      const fetchFromGitHub = async () => {
        const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/prompts?ref=${encodeURIComponent(branch)}`;
        const response = await fetch(apiUrl, {
          headers: { Accept: 'application/vnd.github.v3+json' }
        });
        if (!response.ok) {
          throw new Error(`GitHub API error ${response.status}`);
        }
        const data = await response.json();
        return data
          .filter(entry => entry.type === 'file' && entry.name.toLowerCase().endsWith('.html'))
          .map(entry => entry.name);
      };

      const cached = (() => {
        try {
          const raw = localStorage.getItem(cacheKey);
          if (!raw) return null;
          return JSON.parse(raw);
        } catch {
          return null;
        }
      })();

      (async () => {
        try {
          const files = await fetchFromGitHub();
          renderList(files);
          localStorage.setItem(cacheKey, JSON.stringify({ files, timestamp: Date.now() }));
        } catch (error) {
          console.warn('Prompt index fetch failed:', error);
          if (cached?.files?.length) {
            renderList(cached.files, true);
          } else {
            statusEl.classList.replace('alert-info', 'alert-warning');
            statusEl.textContent = 'Unable to load prompt list right now.';
          }
        }
      })();
    }
  </script>
</body>
</html>
